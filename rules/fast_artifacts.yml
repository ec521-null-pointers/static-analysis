rules:
  # --- URLs (http/https) ---
  - id: npm-url-capture
    message: "Suspicious URL: $URL"
    severity: INFO
    languages: [generic]
    pattern: $URL
    metavariable-regex:
      URL: "https?://[^\\s\"'()<>]+"

  # --- Base64 (standard alphabet, valid 4-char blocks + padding) ---
  - id: npm-base64-capture
    message: "Base64 blob: $B64"
    severity: INFO
    languages: [generic]
    pattern: $B64
    metavariable-regex:
      B64: "(?:[A-Za-z0-9+/]{4}){10,}(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?"

  # --- Base64 (URL-safe alphabet -/_ with valid padding) ---
  - id: npm-base64-urlsafe-capture
    message: "URL-safe Base64 blob: $B64U"
    severity: INFO
    languages: [generic]
    pattern: $B64U
    metavariable-regex:
      B64U: "(?:[A-Za-z0-9_-]{4}){10,}(?:[A-Za-z0-9_-]{2}==|[A-Za-z0-9_-]{3}=)?"

  # --- Token-ish (key name + quoted value) ---
  - id: npm-token-capture
    message: "Possible token/key: $PAIR"
    severity: INFO
    languages: [generic]
    pattern: $PAIR
    metavariable-regex:
      PAIR: "(?i)(?:token|secret|api[_-]?key)\\s*[:=]\\s*[\"'][A-Za-z0-9+/=_-]{16,}[\"']"
